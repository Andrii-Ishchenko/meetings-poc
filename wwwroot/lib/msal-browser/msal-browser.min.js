/*! @azure/msal-browser v2.0.0-beta.2 2020-06-18 */
"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).msal={})}(this,function(o){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function e(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function h(i,a,c,s){return new(c=c||Promise)(function(e,t){function r(e){try{o(s.next(e))}catch(e){t(e)}}function n(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(r,n)}o((s=s.apply(i,a||[])).next())})}function p(r,n){var o,i,a,e,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(r,c)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function t(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function l(i,a,c,s){return new(c=c||Promise)(function(e,t){function r(e){try{o(s.next(e))}catch(e){t(e)}}function n(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(r,n)}o((s=s.apply(i,a||[])).next())})}function y(r,n){var o,i,a,e,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(r,c)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function a(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}var c,r={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},u=(t(f,c=Error),f.createUnexpectedError=function(e){return new f(r.unexpectedError.code,r.unexpectedError.desc+": "+e)},f);function f(e,t){var r=this,n=t?e+": "+t:e;return r=c.call(this,n)||this,Object.setPrototypeOf(r,f.prototype),r.errorCode=e,r.errorMessage=t,r.name="AuthError",r}var m,g="1.0.0-beta.2",E=g,v={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},C={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},w={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},I={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},T={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},A={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."},S={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},_={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},R={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},b={code:"account_mismatch",desc:"The cached account and account which made the token request do not match."},O={code:"invalid_id_token",desc:"Invalid ID token format."},k={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},N={code:"cache_parse_error",desc:"Could not parse cache key."},P={code:"user_login_error",desc:"User login is required."},U={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},M={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},x={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},L={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},D={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},H={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},K={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},q={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},j={code:"device_code_expired",desc:"Device code is expired."},G={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},F=(t(z,m=u),z.createClientInfoDecodingError=function(e){return new z(v.code,v.desc+" Failed with error: "+e)},z.createClientInfoEmptyError=function(e){return new z(C.code,C.desc+" Given Object: "+e)},z.createIdTokenParsingError=function(e){return new z(w.code,w.desc+" Failed with error: "+e)},z.createIdTokenNullOrEmptyError=function(e){return new z(I.code,I.desc+" Raw ID Token Value: "+e)},z.createEndpointDiscoveryIncompleteError=function(e){return new z(T.code,T.desc+" Detail: "+e)},z.createInvalidAuthorityTypeError=function(e){return new z(A.code,A.desc+" Given Url: "+e)},z.createHashNotDeserializedError=function(e){return new z(S.code,S.desc+" Given Object: "+e)},z.createStateMismatchError=function(){return new z(_.code,_.desc)},z.createNonceMismatchError=function(){return new z(R.code,R.desc)},z.createAccountMismatchError=function(){return new z(b.code,b.desc)},z.createInvalidIdTokenError=function(e){return new z(O.code,O.desc+" Given token: "+JSON.stringify(e))},z.createNoTokensFoundError=function(){return new z(k.code,k.desc)},z.createCacheParseError=function(e){return new z(N.code,N.desc+" Cache key: "+e)},z.createUserLoginRequiredError=function(){return new z(P.code,P.desc)},z.createMultipleMatchingTokensInCacheError=function(e){return new z(U.code,"Cache error for scope "+e+": "+U.desc+".")},z.createMultipleMatchingAccountsInCacheError=function(){return new z(M.code,M.desc)},z.createTokenRequestCannotBeMadeError=function(){return new z(x.code,x.desc)},z.createAppendEmptyScopeToSetError=function(e){return new z(L.code,L.desc+" Given Scope: "+e)},z.createRemoveEmptyScopeFromSetError=function(e){return new z(D.code,D.desc+" Given Scope: "+e)},z.createAppendScopeSetError=function(e){return new z(H.code,H.desc+" Detail Error: "+e)},z.createEmptyInputScopeSetError=function(e){return new z(K.code,K.desc+" Given ScopeSet: "+e)},z.createDeviceCodeCancelledError=function(){return new z(q.code,""+q.desc)},z.createDeviceCodeExpiredError=function(){return new z(j.code,""+j.desc)},z.createNoAccountInSilentRequestError=function(){return new z(G.code,""+G.desc)},z);function z(e,t){var r=m.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,z.prototype),r}var B,W=(Y.decodeJwt=function(e){if(Y.isEmpty(e))throw F.createIdTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw F.createIdTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},Y.isEmpty=function(e){return void 0===e||!e||0===e.length},Y.queryStringToObject=function(e){function t(e){return decodeURIComponent(e.replace(n," "))}var r,n=/\+/g,o=/([^&=]+)=([^&]*)/g,i={};for(r=o.exec(e);r;)i[t(r[1])]=t(r[2]),r=o.exec(e);return i},Y.trimAndConvertArrayEntriesToLowerCase=function(e){return e.map(function(e){return e.trim().toLowerCase()})},Y.removeEmptyStringsFromArray=function(e){return e.filter(function(e){return!Y.isEmpty(e)})},Y);function Y(){}(B=o.LogLevel||(o.LogLevel={}))[B.Error=0]="Error",B[B.Warning=1]="Warning",B[B.Info=2]="Info",B[B.Verbose=3]="Verbose";var V=(Q.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(W.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+E+" : "+o.LogLevel[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii)}},Q.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},Q.prototype.error=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Error,containsPii:!1,correlationId:t||""})},Q.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Error,containsPii:!0,correlationId:t||""})},Q.prototype.warning=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Warning,containsPii:!1,correlationId:t||""})},Q.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Warning,containsPii:!0,correlationId:t||""})},Q.prototype.info=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Info,containsPii:!1,correlationId:t||""})},Q.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Info,containsPii:!0,correlationId:t||""})},Q.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Verbose,containsPii:!1,correlationId:t||""})},Q.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:o.LogLevel.Verbose,containsPii:!0,correlationId:t||""})},Q.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Q);function Q(e){this.level=o.LogLevel.Info,e&&(this.localCallback=e.loggerCallback,this.piiLoggingEnabled=e.piiLoggingEnabled,this.level=e.logLevel)}var J,X,Z,$="MSAL.JS",ee="msal.js.common",te="msal",re="https://login.microsoftonline.com/common",ne="adfs",oe="https://login.microsoftonline.com/common/discovery/instance",ie="|",ae="openid",ce="profile",se="code",ue="S256",de="application/x-www-form-urlencoded;charset=utf-8",he="authorization_pending",pe="not_defined";(J||(J={})).CONTENT_TYPE="Content-Type",(Z=X=X||{}).ID_TOKEN="idtoken",Z.CLIENT_INFO="client.info",Z.ADAL_ID_TOKEN="adal.idtoken",Z.ERROR="error",Z.ERROR_DESC="error.description";var le,fe,ye,me,ge,Ee,ve=["login.windows.net","login.chinacloudapi.cn","login.cloudgovapi.us","login.microsoftonline.com","login.microsoftonline.de","login.microsoftonline.us"],Ce=["login.microsoftonline.com","login.windows.net","login.windows-ppe.net","login.microsoft.com","sts.windows.net"],we="login.windows.net";(fe=le=le||{}).COMMON="common",fe.ORGANIZATIONS="organizations",fe.CONSUMERS="consumers",(me=ye=ye||{}).CLIENT_ID="client_id",me.REDIRECT_URI="redirect_uri",me.RESPONSE_TYPE="response_type",me.RESPONSE_MODE="response_mode",me.GRANT_TYPE="grant_type",me.CLAIMS="claims",me.SCOPE="scope",me.ERROR="error",me.ERROR_DESCRIPTION="error_description",me.ACCESS_TOKEN="access_token",me.ID_TOKEN="id_token",me.REFRESH_TOKEN="refresh_token",me.EXPIRES_IN="expires_in",me.STATE="state",me.NONCE="nonce",me.PROMPT="prompt",me.SESSION_STATE="session_state",me.CLIENT_INFO="client_info",me.CODE="code",me.CODE_CHALLENGE="code_challenge",me.CODE_CHALLENGE_METHOD="code_challenge_method",me.CODE_VERIFIER="code_verifier",me.CLIENT_REQUEST_ID="client-request-id",me.X_CLIENT_SKU="x-client-SKU",me.X_CLIENT_VER="x-client-VER",me.X_CLIENT_OS="x-client-OS",me.X_CLIENT_CPU="x-client-CPU",me.POST_LOGOUT_URI="post_logout_redirect_uri",me.DEVICE_CODE="device_code",(Ee=ge=ge||{}).ISSUER="iss",Ee.OBJID="oid",Ee.SUBJECT="sub",Ee.TENANTID="tid",Ee.VERSION="ver",Ee.PREF_USERNAME="preferred_username",Ee.NAME="name",Ee.NONCE="nonce",Ee.EXPIRATION="exp",Ee.HOME_OBJID="home_oid",Ee.SESSIONID="sid",Ee.CLOUD_INSTANCE_HOSTNAME="cloud_instance_host_name";var Ie,Te,Ae={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};(Te=Ie=Ie||{}).ACCOUNT="account",Te.SID="sid",Te.LOGIN_HINT="login_hint",Te.ID_TOKEN="id_token",Te.DOMAIN_HINT="domain_hint",Te.ORGANIZATIONS="organizations",Te.CONSUMERS="consumers",Te.ACCOUNT_ID="accountIdentifier",Te.HOMEACCOUNT_ID="homeAccountIdentifier";Ie.SID,Ie.LOGIN_HINT;var Se,_e,Re,be,Oe,ke,Ne,Pe,Ue,Me,xe,Le,De,He,Ke={PLAIN:"plain",S256:"S256"};(_e=Se=Se||{}).QUERY="query",_e.FRAGMENT="fragment",_e.FORM_POST="form_post",(be=Re=Re||{}).IMPLICIT_GRANT="implicit",be.AUTHORIZATION_CODE_GRANT="authorization_code",be.CLIENT_CREDENTIALS_GRANT="client_credentials",be.RESOURCE_OWNER_PASSWORD_GRANT="password",be.REFRESH_TOKEN_GRANT="refresh_token",be.DEVICE_CODE_GRANT="device_code",(ke=Oe=Oe||{}).MSSTS_ACCOUNT_TYPE="MSSTS",ke.ADFS_ACCOUNT_TYPE="ADFS",ke.MSAV1_ACCOUNT_TYPE="MSA",ke.GENERIC_ACCOUNT_TYPE="Generic",(Pe=Ne=Ne||{}).CACHE_KEY_SEPARATOR="-",Pe.CLIENT_INFO_SEPARATOR=".",(Me=Ue=Ue||{}).ID_TOKEN="idtoken",Me.ACCESS_TOKEN="accesstoken",Me.REFRESH_TOKEN="refreshtoken",(Le=xe=xe||{}).ACCOUNT="Account",Le.CREDENTIAL="Credential",Le.APP_META_DATA="AppMetadata",Le.TEMPORARY="TempCache",(He=De=De||{})[He.ADFS=1001]="ADFS",He[He.MSA=1002]="MSA",He[He.MSSTS=1003]="MSSTS",He[He.GENERIC=1004]="GENERIC",He[He.ACCESS_TOKEN=2001]="ACCESS_TOKEN",He[He.REFRESH_TOKEN=2002]="REFRESH_TOKEN",He[He.ID_TOKEN=2003]="ID_TOKEN",He[He.APP_META_DATA=3001]="APP_META_DATA";var qe="appmetadata",je={clientId:"",authority:null,knownAuthorities:[],redirectUri:"",postLogoutRedirectUri:""},Ge={storeInMemory:!0,tokenRenewalOffsetSeconds:300,telemetry:null},Fe={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:o.LogLevel.Info},ze={clear:function(){throw u.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},containsKey:function(){throw u.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},getItem:function(){throw u.createUnexpectedError("Storage interface - getItem() has not been implemented for the cacheStorage interface.")},getKeys:function(){throw u.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},removeItem:function(){throw u.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},setItem:function(){throw u.createUnexpectedError("Storage interface - setItem() has not been implemented for the cacheStorage interface.")},getCache:function(){throw u.createUnexpectedError("Storage interface - getCache() has not been implemented for the cacheStorage interface.")},setCache:function(){throw u.createUnexpectedError("Storage interface - setCache() has not been implemented for the cacheStorage interface.")}},Be={sendGetRequestAsync:function(){return l(this,void 0,void 0,function(){return y(this,function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",u.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return l(this,void 0,void 0,function(){return y(this,function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",u.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},We={createNewGuid:function(){throw u.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw u.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw u.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return l(this,void 0,void 0,function(){return y(this,function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",u.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})}},Ye={sku:ee,version:g,cpu:"",os:""};var Ve,Qe={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Je={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Xe={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Ze={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},$e={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},et={code:"empty_url_error",desc:"URL was empty or null."},tt={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},rt={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},nt={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},ot={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},it={code:"token_request_empty",desc:"Token request was empty and not found in cache."},at={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},ct={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},st={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},ut={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. If using B2C, please include this authority in the knownAuthorities config parameter."},dt=(t(ht,Ve=F),ht.createRedirectUriEmptyError=function(){return new ht(Qe.code,Qe.desc)},ht.createPostLogoutRedirectUriEmptyError=function(){return new ht(Je.code,Je.desc)},ht.createClaimsRequestParsingError=function(e){return new ht(Xe.code,Xe.desc+" Given value: "+e)},ht.createInsecureAuthorityUriError=function(e){return new ht(Ze.code,Ze.desc+" Given URI: "+e)},ht.createUrlParseError=function(e){return new ht($e.code,$e.desc+" Given Error: "+e)},ht.createUrlEmptyError=function(){return new ht(et.code,et.desc)},ht.createScopesNonArrayError=function(e){return new ht(rt.code,rt.desc+" Given Scopes: "+e)},ht.createEmptyScopesArrayError=function(e){return new ht(tt.code,tt.desc+" Given Scopes: "+e)},ht.createClientIdSingleScopeError=function(e){return new ht(nt.code,nt.desc+" Given Scopes: "+e)},ht.createInvalidPromptError=function(e){return new ht(ot.code,ot.desc+" Given value: "+e)},ht.createEmptyTokenRequestError=function(){return new ht(it.code,it.desc)},ht.createInvalidCodeChallengeMethodError=function(){return new ht(at.code,at.desc)},ht.createInvalidCodeChallengeParamsError=function(){return new ht(ct.code,ct.desc)},ht.createKnownAuthoritiesNotSetError=function(){return new ht(st.code,st.desc)},ht.createUntrustedAuthorityError=function(){return new ht(ut.code,ut.desc)},ht);function ht(e,t){var r=Ve.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,ht.prototype),r}var pt=(Object.defineProperty(lt.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),lt.prototype.canonicalizeUri=function(e){return(e=e&&e.toLowerCase())&&!e.endsWith("/")&&(e+="/"),e},lt.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw dt.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments||e.PathSegments.length<1)throw dt.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw dt.createInsecureAuthorityUriError(this.urlString)},lt.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},lt.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==le.COMMON&&r[0]!==le.ORGANIZATIONS||(r[0]=e),lt.constructAuthorityUriFromObject(t)},lt.prototype.getHash=function(){var e=this.urlString.indexOf("#"),t=this.urlString.indexOf("#/");return-1<t?this.urlString.substring(t+2):-1<e?this.urlString.substring(e+1):""},lt.prototype.getDeserializedHash=function(){var e=this.getHash(),t=W.queryStringToObject(e);if(!t)throw F.createHashNotDeserializedError(JSON.stringify(t));return t},lt.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw dt.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},n=r.AbsolutePath.split("/");return n=n.filter(function(e){return e&&0<e.length}),r.PathSegments=n,r},lt.constructAuthorityUriFromObject=function(e){return new lt(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},lt.hashContainsKnownProperties=function(e){if(W.isEmpty(e))return!1;var t=new lt(e).getDeserializedHash();return!!(t.error_description||t.error||t.state)},lt);function lt(e){if(this._urlString=e,!W.isEmpty(this._urlString)&&W.isEmpty(this.getHash()))this._urlString=this.canonicalizeUri(e);else if(W.isEmpty(this._urlString))throw dt.createUrlEmptyError()}var ft,yt,mt=(Object.defineProperty(gt.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new pt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),gt.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(gt.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),gt.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},gt.prototype.discoverEndpoints=function(t){return l(this,void 0,void 0,function(){return y(this,function(e){return[2,this.networkInterface.sendGetRequestAsync(t)]})})},gt.prototype.resolveEndpointsAsync=function(){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){switch(e.label){case 0:return[4,this.getOpenIdConfigurationEndpointAsync()];case 1:return t=e.sent(),[4,this.discoverEndpoints(t)];case 2:return r=e.sent(),this.tenantDiscoveryResponse=r.body,[2]}})})},gt);function gt(e,t){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t}(yt=ft=ft||{})[yt.Aad=0]="Aad",yt[yt.Adfs=1]="Adfs",yt[yt.B2C=2]="B2C";var Et,vt=(t(Ct,Et=mt),Ct.setKnownAuthorities=function(e){0===Ct.B2CTrustedHostList.length&&e.forEach(function(e){Ct.B2CTrustedHostList.push(e)})},Object.defineProperty(Ct.prototype,"authorityType",{get:function(){return ft.B2C},enumerable:!0,configurable:!0}),Ct.prototype.getOpenIdConfigurationEndpointAsync=function(){return l(this,void 0,void 0,function(){return y(this,function(e){if(this.isInTrustedHostList(this.canonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.defaultOpenIdConfigurationEndpoint];throw dt.createUntrustedAuthorityError()})})},Ct.prototype.isInTrustedHostList=function(e){return-1<Ct.B2CTrustedHostList.indexOf(e)},Ct.B2CTrustedHostList=[],Ct);function Ct(e,t){return Et.call(this,e,t)||this}function wt(e,t){if(W.isEmpty(e))throw F.createClientInfoEmptyError(e);try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw F.createClientInfoDecodingError(e)}}var It=(Tt.fromString=function(e){return new Tt((e=e||"").split(" "))},Tt.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw dt.createEmptyScopesArrayError(e)},Tt.prototype.containsScope=function(e){return!W.isEmpty(e)&&this.scopes.has(e)},Tt.prototype.containsScopeSet=function(e){var t=this;return!!e&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})},Tt.prototype.appendScope=function(e){if(W.isEmpty(e))throw F.createAppendEmptyScopeToSetError(e);this.scopes.add(e.trim().toLowerCase())},Tt.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(e){return t.scopes.add(e)})}catch(e){throw F.createAppendScopeSetError(e)}},Tt.prototype.removeScope=function(e){if(W.isEmpty(e))throw F.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim().toLowerCase())},Tt.prototype.unionScopeSets=function(e){if(!e)throw F.createEmptyInputScopeSetError(e);return new Set(a(e.asArray(),Array.from(this.scopes)))},Tt.prototype.intersectingScopeSets=function(e){if(!e)throw F.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},Tt.prototype.getScopeCount=function(){return this.scopes.size},Tt.prototype.asArray=function(){return Array.from(this.scopes)},Tt.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},Tt);function Tt(e){var t=e?W.trimAndConvertArrayEntriesToLowerCase(a(e)):[],r=t?W.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set(r)}var At=(St.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},St.swap=function(e){var t={};for(var r in e)t[e[r]]=r;return t},St.renameKeys=function(r,n){var e=Object.keys(r).map(function(e){var t;return r[e]?((t={})[n[e]||e]=r[e],t):null});return Object.assign.apply(Object,a([{}],e))},St.matchHomeAccountId=function(e,t){return t===e.homeAccountId},St.matchEnvironment=function(e,t){return!(!Ce.includes(t)||!Ce.includes(e.environment))},St.matchCredentialType=function(e,t){return t.toLowerCase()===e.credentialType.toLowerCase()},St.matchClientId=function(e,t){return t===e.clientId},St.matchRealm=function(e,t){return t===e.realm},St.matchTarget=function(e,t){var r=It.fromString(e.target),n=It.fromString(t);return r.containsScopeSet(n)},St.getCredentialType=function(e){return-1!==e.indexOf(Ue.ACCESS_TOKEN)?Ue.ACCESS_TOKEN:-1!==e.indexOf(Ue.ID_TOKEN)?Ue.ID_TOKEN:-1!==e.indexOf(Ue.REFRESH_TOKEN)?Ue.REFRESH_TOKEN:pe},St.isAppMetadata=function(e){return-1!==e.indexOf(qe)},St.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},St.generateAccountIdForCacheKey=function(e,t){return[e,t].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},St.generateCredentialCacheKey=function(e,t,r,n,o,i,a){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i)].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},St.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===Ue.REFRESH_TOKEN&&n||t,r||""].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},St.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},St.toIAccount=function(e){return{homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.realm,username:e.username}},St);function St(){}var _t=(Rt.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},Rt.prototype.generateAccountKey=function(){return At.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username})},Rt.prototype.generateType=function(){switch(this.authorityType){case Oe.ADFS_ACCOUNT_TYPE:return De.ADFS;case Oe.MSAV1_ACCOUNT_TYPE:return De.MSA;case Oe.MSSTS_ACCOUNT_TYPE:return De.MSSTS;case Oe.GENERIC_ACCOUNT_TYPE:return De.GENERIC;default:return console.log("Unexpected account type"),null}},Rt.createAccount=function(e,t,r,n,o){var i=new Rt;i.authorityType=Oe.MSSTS_ACCOUNT_TYPE;var a=wt(i.clientInfo=e,o),c=""+a.uid+Ne.CLIENT_INFO_SEPARATOR+a.utid;i.homeAccountId=null!==n?c+Ne.CACHE_KEY_SEPARATOR+n:c;var s=t.canonicalAuthorityUrlComponents.HostNameAndPort;if(i.environment=Ce.includes(s)?we:s,i.realm=r.claims.tid,r){var u=W.isEmpty(r.claims.oid)?r.claims.sid:r.claims.oid;i.localAccountId=u,i.username=r.claims.preferred_username,i.name=r.claims.name}return i},Rt.createADFSAccount=function(e,t){var r=new Rt;return r.authorityType=Oe.ADFS_ACCOUNT_TYPE,r.homeAccountId=t.claims.sub,r.environment=e.canonicalAuthorityUrlComponents.HostNameAndPort,r.username=t.claims.upn,r},Rt);function Rt(){}var bt=(Ot.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},Ot.prototype.generateCredentialId=function(){var e=Ue.REFRESH_TOKEN&&this.familyId||this.clientId;return[this.credentialType,e,this.realm||""].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},Ot.prototype.generateTarget=function(){return(this.target||"").toLowerCase()},Ot.prototype.generateCredentialKey=function(){return[this.generateAccountId(),this.generateCredentialId(),this.generateTarget()].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},Ot.prototype.generateType=function(){switch(this.credentialType){case Ue.ID_TOKEN:return De.ID_TOKEN;case Ue.ACCESS_TOKEN:return De.ACCESS_TOKEN;case Ue.REFRESH_TOKEN:return De.REFRESH_TOKEN;default:return console.log("Unexpected credential type"),null}},Ot);function Ot(){}var kt,Nt=(t(Pt,kt=bt),Pt.createIdTokenEntity=function(e,t,r,n,o){var i=new Pt;return i.credentialType=Ue.ID_TOKEN,i.homeAccountId=e,i.environment=t,i.clientId=n,i.secret=r,i.realm=o,i},Pt);function Pt(){return null!==kt&&kt.apply(this,arguments)||this}var Ut=(Mt.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},Mt);function Mt(){}var xt,Lt=(t(Dt,xt=bt),Dt.createAccessTokenEntity=function(e,t,r,n,o,i,a,c){var s=new Dt;s.homeAccountId=e,s.credentialType=Ue.ACCESS_TOKEN,s.secret=r;var u=Ut.nowSeconds();return s.cachedAt=u.toString(),s.expiresOn=a.toString(),s.extendedExpiresOn=c.toString(),s.environment=t,s.clientId=n,s.realm=o,s.target=i,s},Dt);function Dt(){return null!==xt&&xt.apply(this,arguments)||this}var Ht,Kt=(t(qt,Ht=bt),qt.createRefreshTokenEntity=function(e,t,r,n,o){var i=new qt;return i.clientId=n,i.credentialType=Ue.REFRESH_TOKEN,i.environment=t,i.homeAccountId=e,i.secret=r,o&&(i.familyId=o),i},qt);function qt(){return null!==Ht&&Ht.apply(this,arguments)||this}var jt=(Gt.prototype.generateAppMetaDataEntityKey=function(){return[qe,this.environment,this.clientId].join(Ne.CACHE_KEY_SEPARATOR).toLowerCase()},Gt);function Gt(){}var Ft=(zt.toCacheMap={homeAccountId:"home_account_id",environment:"environment",realm:"realm",localAccountId:"local_account_id",username:"username",authorityType:"authority_type",name:"name",clientInfo:"client_info",lastModificationTime:"last_modification_time",lastModificationApp:"last_modification_app"},zt.fromCacheMap=At.swap(zt.toCacheMap),zt);function zt(){}var Bt=(Wt.toCacheMap={homeAccountId:"home_account_id",environment:"environment",credentialType:"credential_type",clientId:"client_id",secret:"secret",realm:"realm"},Wt.fromCacheMap=At.swap(Wt.toCacheMap),Wt);function Wt(){}var Yt=(Vt.toCacheMap={homeAccountId:"home_account_id",environment:"environment",credentialType:"credential_type",clientId:"client_id",secret:"secret",realm:"realm",target:"target",cachedAt:"cached_at",expiresOn:"expires_on",extendedExpiresOn:"extended_expires_on",refreshOn:"refresh_on",keyId:"key_id",tokenType:"token_type"},Vt.fromCacheMap=At.swap(Vt.toCacheMap),Vt);function Vt(){}var Qt=(Jt.toCacheMap={homeAccountId:"home_account_id",environment:"environment",credentialType:"credential_type",clientId:"client_id",secret:"secret"},Jt.fromCacheMap=At.swap(Jt.toCacheMap),Jt);function Jt(){}var Xt=(Zt.toCacheMap={clientId:"client_id",environment:"environment",familyId:"family_id"},Zt.fromCacheMap=At.swap(Zt.toCacheMap),Zt);function Zt(){}var $t=(er.deserializeJSONBlob=function(e){return W.isEmpty(e)?{}:JSON.parse(e)},er.deserializeAccounts=function(n){var o={};return Object.keys(n).map(function(e){var t=At.renameKeys(n[e],Ft.fromCacheMap),r=new _t;At.toObject(r,t),o[e]=r}),o},er.deserializeIdTokens=function(n){var o={};return Object.keys(n).map(function(e){var t=At.renameKeys(n[e],Bt.fromCacheMap),r=new Nt;At.toObject(r,t),o[e]=r}),o},er.deserializeAccessTokens=function(n){var o={};return Object.keys(n).map(function(e){var t=At.renameKeys(n[e],Yt.fromCacheMap),r=new Lt;At.toObject(r,t),o[e]=r}),o},er.deserializeRefreshTokens=function(n){var o={};return Object.keys(n).map(function(e){var t=At.renameKeys(n[e],Qt.fromCacheMap),r=new Kt;At.toObject(r,t),o[e]=r}),o},er.deserializeAppMetadata=function(n){var o={};return Object.keys(n).map(function(e){var t=At.renameKeys(n[e],Xt.fromCacheMap),r=new jt;At.toObject(r,t),o[e]=r}),o},er.deserializeAllCache=function(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}},er);function er(){}var tr=(rr.mapAccountKeys=function(e,t){return At.renameKeys(e[t],Ft.toCacheMap)},rr.mapIdTokenKeys=function(e,t){return At.renameKeys(e[t],Bt.toCacheMap)},rr.mapAccessTokenKeys=function(e,t){return At.renameKeys(e[t],Yt.toCacheMap)},rr.mapRefreshTokenKeys=function(e,t){return At.renameKeys(e[t],Qt.toCacheMap)},rr.mapAppMetadataKeys=function(e,t){return At.renameKeys(e[t],Xt.toCacheMap)},rr);function rr(){}var nr=(or.serializeJSONBlob=function(e){return JSON.stringify(e)},or.serializeAccounts=function(t){var r={};return Object.keys(t).map(function(e){r[e]=tr.mapAccountKeys(t,e)}),r},or.serializeIdTokens=function(t){var r={};return Object.keys(t).map(function(e){r[e]=tr.mapIdTokenKeys(t,e)}),r},or.serializeAccessTokens=function(t){var r={};return Object.keys(t).map(function(e){r[e]=tr.mapAccessTokenKeys(t,e)}),r},or.serializeRefreshTokens=function(t){var r={};return Object.keys(t).map(function(e){r[e]=tr.mapRefreshTokenKeys(t,e)}),r},or.serializeAppMetadata=function(t){var r={};return Object.keys(t).map(function(e){r[e]=tr.mapAppMetadataKeys(t,e)}),r},or.serializeAllCache=function(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}},or);function or(){}var ir=(ar.prototype.generateInMemoryCache=function(e){return $t.deserializeAllCache($t.deserializeJSONBlob(e))},ar.prototype.generateJsonCache=function(e){return nr.serializeAllCache(e)},ar.prototype.getAllAccounts=function(){return this.getAccountsFilteredBy()},ar.prototype.saveCacheRecord=function(e,t){this.saveAccount(e.account),this.saveCredential(e.idToken),this.saveAccessToken(e.accessToken,t),this.saveCredential(e.refreshToken)},ar.prototype.saveAccount=function(e){var t=e.generateAccountKey();this.cacheStorage.setItem(t,e,xe.ACCOUNT,this.inMemory)},ar.prototype.saveCredential=function(e){var t=e.generateCredentialKey();this.cacheStorage.setItem(t,e,xe.CREDENTIAL,this.inMemory)},ar.prototype.saveAccessToken=function(e,t){var r=this,n=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:Ue.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),o=Object.values(n.accessTokens);o&&o.forEach(function(e){It.fromString(e.target).intersectingScopeSets(t)&&r.removeCredential(e)}),this.saveCredential(e)},ar.prototype.getAccount=function(e){return this.cacheStorage.getItem(e,xe.ACCOUNT,this.inMemory)},ar.prototype.getCredential=function(e){return this.cacheStorage.getItem(e,xe.CREDENTIAL,this.inMemory)},ar.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},ar.prototype.getAccountsFilteredByInternal=function(n,o,i){var a=this,e=this.cacheStorage.getKeys(),c={};return e.forEach(function(e){var t=!0;if(At.getCredentialType(e)===pe&&!At.isAppMetadata(e)){var r=a.cacheStorage.getItem(e,xe.ACCOUNT);W.isEmpty(n)||(t=At.matchHomeAccountId(r,n)),W.isEmpty(o)||(t=t&&At.matchEnvironment(r,o)),W.isEmpty(i)||(t=t&&At.matchRealm(r,i)),t&&(c[e]=r)}}),c},ar.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.realm,e.target)},ar.prototype.getCredentialsFilteredByInternal=function(o,i,a,c,s,u){var d=this,e=this.cacheStorage.getKeys(),h={idTokens:{},accessTokens:{},refreshTokens:{}};return e.forEach(function(e){var t=!0,r=At.getCredentialType(e);if(r!==pe){var n=d.cacheStorage.getItem(e,xe.CREDENTIAL);if(W.isEmpty(o)||(t=At.matchHomeAccountId(n,o)),W.isEmpty(i)||(t=t&&At.matchEnvironment(n,i)),W.isEmpty(s)||(t=t&&At.matchRealm(n,s)),W.isEmpty(a)||(t=t&&At.matchCredentialType(n,a)),W.isEmpty(c)||(t=t&&At.matchClientId(n,c)),W.isEmpty(u)||r!==Ue.ACCESS_TOKEN||(t=t&&At.matchTarget(n,u)),t)switch(r){case Ue.ID_TOKEN:h.idTokens[e]=n;break;case Ue.ACCESS_TOKEN:h.accessTokens[e]=n;break;case Ue.REFRESH_TOKEN:h.refreshTokens[e]=n}}}),h},ar.prototype.removeAccount=function(e){var t=this.getAccount(e);return this.removeAccountContext(t)&&this.cacheStorage.removeItem(e,xe.ACCOUNT,this.inMemory)},ar.prototype.removeAccountContext=function(e){var r=this,t=this.cacheStorage.getKeys(),n=e.generateAccountId();return t.forEach(function(e){if(At.getCredentialType(e)!==pe){var t=r.cacheStorage.getItem(e,xe.CREDENTIAL,r.inMemory);t&&n===t.generateAccountId()&&r.removeCredential(t)}}),!0},ar.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.cacheStorage.removeItem(t,xe.CREDENTIAL,this.inMemory)},ar);function ar(e,t,r){this.cacheStorage=e,this.clientId=t,this.inMemory=r}var cr=(sr.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e.set(J.CONTENT_TYPE,de),e},sr.prototype.createDefaultLibraryHeaders=function(){var e=new Map;return e.set(""+ye.X_CLIENT_SKU,this.config.libraryInfo.sku),e.set(""+ye.X_CLIENT_VER,this.config.libraryInfo.version),e.set(""+ye.X_CLIENT_OS,this.config.libraryInfo.os),e.set(""+ye.X_CLIENT_CPU,this.config.libraryInfo.cpu),e},sr.prototype.executePostToTokenEndpoint=function(e,t,r){return this.networkClient.sendPostRequestAsync(e,{body:t,headers:r})},sr.prototype.getAllAccounts=function(){var e=this.unifiedCacheManager.getAllAccounts(),t=Object.values(e);return t.length<1?null:t.map(function(e){var t=JSON.parse(JSON.stringify(e));return At.toIAccount(t)})},sr);function sr(e){this.config=function(e){var t=e.authOptions,r=e.systemOptions,n=e.loggerOptions,o=e.storageInterface,i=e.networkInterface,a=e.cryptoInterface,c=e.libraryInfo;return{authOptions:s(s({},je),t),systemOptions:s(s({},Ge),r),loggerOptions:s(s({},Fe),n),storageInterface:o||ze,networkInterface:i||Be,cryptoInterface:a||We,libraryInfo:s(s({},Ye),c)}}(e),this.logger=new V(this.config.loggerOptions),this.cryptoUtils=this.config.cryptoInterface,this.cacheStorage=this.config.storageInterface,this.unifiedCacheManager=new ir(this.cacheStorage,this.config.authOptions.clientId,this.config.systemOptions.storeInMemory),this.networkClient=this.config.networkInterface,vt.setKnownAuthorities(this.config.authOptions.knownAuthorities),this.defaultAuthority=this.config.authOptions.authority}var ur,dr=(t(hr,ur=mt),Object.defineProperty(hr.prototype,"authorityType",{get:function(){return ft.Aad},enumerable:!0,configurable:!0}),Object.defineProperty(hr.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return oe+"?api-version=1.0&authorization_endpoint="+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),hr.prototype.getOpenIdConfigurationEndpointAsync=function(){return l(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.isInTrustedHostList(this.canonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.defaultOpenIdConfigurationEndpoint]:[4,this.networkInterface.sendGetRequestAsync(this.aadInstanceDiscoveryEndpointUrl)];case 1:return[2,e.sent().body.tenant_discovery_endpoint]}})})},hr.prototype.isInTrustedHostList=function(e){return ve.includes(e)},hr);function hr(e,t){return ur.call(this,e,t)||this}var pr,lr=(t(fr,pr=mt),Object.defineProperty(fr.prototype,"authorityType",{get:function(){return ft.Adfs},enumerable:!0,configurable:!0}),fr.prototype.getOpenIdConfigurationEndpointAsync=function(){return l(this,void 0,void 0,function(){return y(this,function(e){return[2,this.canonicalAuthority+".well-known/openid-configuration"]})})},fr);function fr(e,t){return pr.call(this,e,t)||this}var yr=(mr.detectAuthorityFromUrl=function(e){var t=new pt(e).getUrlComponents().PathSegments;return t.length&&t[0].toLowerCase()===ne?ft.Adfs:vt.B2CTrustedHostList.length?ft.B2C:ft.Aad},mr.createInstance=function(e,t){if(W.isEmpty(e))throw dt.createUrlEmptyError();switch(mr.detectAuthorityFromUrl(e)){case ft.Aad:return new dr(e,t);case ft.B2C:return new vt(e,t);case ft.Adfs:return new lr(e,t);default:throw F.createInvalidAuthorityTypeError(""+e)}},mr);function mr(){}var gr=(Er.extractIdToken=function(e,t){var r=W.decodeJwt(e);if(!r)return null;try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw F.createIdTokenParsingError(JSON.stringify(e))}},Er);function Er(e,t){if(W.isEmpty(e))throw F.createIdTokenNullOrEmptyError(e);this.rawIdToken=e,this.claims=Er.extractIdToken(e,t)}var vr=(Cr.validateRedirectUri=function(e){if(W.isEmpty(e))throw dt.createRedirectUriEmptyError()},Cr.validatePrompt=function(e){if([Ae.LOGIN,Ae.SELECT_ACCOUNT,Ae.CONSENT,Ae.NONE].indexOf(e)<0)throw dt.createInvalidPromptError(e)},Cr.validateCodeChallengeParams=function(e,t){if(W.isEmpty(e)||W.isEmpty(t))throw dt.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},Cr.validateCodeChallengeMethod=function(e){if([Ke.PLAIN,Ke.S256].indexOf(e)<0)throw dt.createInvalidCodeChallengeMethodError()},Cr.sanitizeEQParams=function(r,e){return r?(e.forEach(function(e,t){r[t]&&(console.log("Removed param "+t+" from extraQueryParameters since it was already present in library query parameters."),delete r[t])}),r):null},Cr);function Cr(){}var wr=(Ir.prototype.addResponseTypeCode=function(){this.parameters.set(ye.RESPONSE_TYPE,encodeURIComponent(se))},Ir.prototype.addResponseMode=function(e){this.parameters.set(ye.RESPONSE_MODE,encodeURIComponent(e||Se.QUERY))},Ir.prototype.addScopes=function(e){this.parameters.set(ye.SCOPE,encodeURIComponent(e.printScopes()))},Ir.prototype.addClientId=function(e){this.parameters.set(ye.CLIENT_ID,encodeURIComponent(e))},Ir.prototype.addRedirectUri=function(e){vr.validateRedirectUri(e),this.parameters.set(ye.REDIRECT_URI,encodeURIComponent(e))},Ir.prototype.addDomainHint=function(e){this.parameters.set(Ie.DOMAIN_HINT,encodeURIComponent(e))},Ir.prototype.addLoginHint=function(e){this.parameters.set(Ie.LOGIN_HINT,encodeURIComponent(e))},Ir.prototype.addClaims=function(e){this.parameters.set(ye.CLAIMS,encodeURIComponent(e))},Ir.prototype.addCorrelationId=function(e){this.parameters.set(ye.CLIENT_REQUEST_ID,encodeURIComponent(e))},Ir.prototype.addLibraryInfo=function(e){this.parameters.set(ye.X_CLIENT_SKU,e.sku),this.parameters.set(ye.X_CLIENT_VER,e.version),this.parameters.set(ye.X_CLIENT_OS,e.os),this.parameters.set(ye.X_CLIENT_CPU,e.cpu)},Ir.prototype.addPrompt=function(e){vr.validatePrompt(e),this.parameters.set(""+ye.PROMPT,encodeURIComponent(e))},Ir.prototype.addState=function(e){W.isEmpty(e)||this.parameters.set(ye.STATE,encodeURIComponent(e))},Ir.prototype.addNonce=function(e){this.parameters.set(ye.NONCE,encodeURIComponent(e))},Ir.prototype.addCodeChallengeParams=function(e,t){if(vr.validateCodeChallengeParams(e,t),!e||!t)throw dt.createInvalidCodeChallengeParamsError();this.parameters.set(ye.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(ye.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},Ir.prototype.addAuthorizationCode=function(e){this.parameters.set(ye.CODE,encodeURIComponent(e))},Ir.prototype.addDeviceCode=function(e){this.parameters.set(ye.DEVICE_CODE,encodeURIComponent(e))},Ir.prototype.addRefreshToken=function(e){this.parameters.set(ye.REFRESH_TOKEN,encodeURIComponent(e))},Ir.prototype.addCodeVerifier=function(e){this.parameters.set(ye.CODE_VERIFIER,encodeURIComponent(e))},Ir.prototype.addGrantType=function(e){this.parameters.set(ye.GRANT_TYPE,encodeURIComponent(e))},Ir.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},Ir.prototype.addExtraQueryParameters=function(t){var r=this;vr.sanitizeEQParams(t,this.parameters),Object.keys(t).forEach(function(e){r.parameters.set(e,t[e])})},Ir.prototype.createQueryString=function(){var r=new Array;return this.parameters.forEach(function(e,t){r.push(t+"="+e)}),r.join("&")},Ir);function Ir(){this.parameters=new Map}var Tr,Ar=(t(Sr,Tr=u),Sr);function Sr(e,t,r){var n=Tr.call(this,e,t)||this;return n.name="ServerError",n.subError=r,Object.setPrototypeOf(n,Sr.prototype),n}var _r,Rr=["interaction_required","consent_required","login_required"],br=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Or=(t(kr,_r=Ar),kr.isInteractionRequiredError=function(e,t,r){var n=!W.isEmpty(e)&&-1<Rr.indexOf(e),o=!W.isEmpty(r)&&-1<br.indexOf(r),i=!W.isEmpty(t)&&Rr.some(function(e){return-1<t.indexOf(e)});return n||i||o},kr);function kr(e,t,r){var n=_r.call(this,e,t,r)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,kr.prototype),n}var Nr=function(e,t,r,n){this.account=e,this.idToken=t,this.accessToken=r,this.refreshToken=n},Pr=(Ur.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(e.state!==t)throw F.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Or.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Or(e.error,e.error_description,e.suberror);throw new Ar(e.error,e.error_description,e.suberror)}e.client_info&&wt(e.client_info,r)},Ur.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Or.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Or(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Ar(e.error,t)}e.client_info&&(this.clientInfo=wt(e.client_info,this.cryptoObj),W.isEmpty(this.clientInfo.uid)||W.isEmpty(this.clientInfo.utid)||(this.homeAccountIdentifier=this.clientInfo.uid+"."+this.clientInfo.utid))},Ur.prototype.generateAuthenticationResult=function(e,t,r){var n=new gr(e.id_token,this.cryptoObj);if(!W.isEmpty(r)&&n.claims.nonce!==r)throw F.createNonceMismatchError();var o=this.generateCacheRecord(e,n,t),i=It.fromString(e.scope);return this.uCacheManager.saveCacheRecord(o,i),{uniqueId:n.claims.oid||n.claims.sub,tenantId:n.claims.tid,scopes:i.asArray(),account:At.toIAccount(o.account),idToken:n.rawIdToken,idTokenClaims:n.claims,accessToken:e.access_token,fromCache:!0,expiresOn:new Date(o.accessToken.expiresOn),extExpiresOn:new Date(o.accessToken.extendedExpiresOn),familyId:e.foci||null}},Ur.prototype.generateAccountEntity=function(e,t,r){var n=r.authorityType;if(!e.client_info)throw F.createClientInfoEmptyError(e.client_info);switch(n){case ft.B2C:return _t.createAccount(e.client_info,r,t,"policy",this.cryptoObj);case ft.Adfs:return _t.createADFSAccount(r,t);default:return _t.createAccount(e.client_info,r,t,null,this.cryptoObj)}},Ur.prototype.generateCacheRecord=function(e,t,r){var n=this.generateAccountEntity(e,t,r),o=r.canonicalAuthorityUrlComponents.HostNameAndPort,i=Ce.includes(o)?we:o,a=Nt.createIdTokenEntity(this.homeAccountIdentifier,i,e.id_token,this.clientId,t.claims.tid),c=It.fromString(e.scope),s=Ut.nowSeconds()+e.expires_in,u=s+e.ext_expires_in,d=Lt.createAccessTokenEntity(this.homeAccountIdentifier,i,e.access_token,this.clientId,t.claims.tid,c.asArray().join(" "),s,u),h=Kt.createRefreshTokenEntity(this.homeAccountIdentifier,i,e.refresh_token,this.clientId,e.foci);return new Nr(n,a,d,h)},Ur);function Ur(e,t,r,n){this.clientId=e,this.uCacheManager=t,this.cryptoObj=r,this.logger=n}var Mr,xr=(t(Lr,Mr=cr),Lr.prototype.createUrl=function(o){return l(this,void 0,void 0,function(){var t,r,n;return y(this,function(e){switch(e.label){case 0:if((t=o&&o.authority?yr.createInstance(o.authority,this.networkClient):this.defaultAuthority).authorityType==ft.Adfs)throw F.createInvalidAuthorityTypeError(t.canonicalAuthority);e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw r=e.sent(),F.createEndpointDiscoveryIncompleteError(r);case 4:return[4,this.createUrlRequestParamString(o)];case 5:return n=e.sent(),[2,t.authorizationEndpoint+"?"+n]}})})},Lr.prototype.createUrlRequestParamString=function(o){return l(this,void 0,void 0,function(){var t,r,n;return y(this,function(e){return(t=new wr).addResponseTypeCode(),t.addClientId(this.config.authOptions.clientId),r=new It(o&&o.scopes||[]),o.extraScopesToConsent&&r.appendScopes(o&&o.extraScopesToConsent),t.addScopes(r),t.addRedirectUri(this.getRedirectUri()),n=o&&o.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(n),t.addCodeChallengeParams(o.codeChallenge,o.codeChallengeMethod||""+ue),t.addState(o.state),t.addNonce(o.nonce||this.config.cryptoInterface.createNewGuid()),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),o&&o.prompt&&t.addPrompt(o.prompt),o&&o.loginHint&&t.addLoginHint(o.loginHint),o&&o.domainHint&&t.addDomainHint(o.domainHint),o&&o.claims&&t.addClaims(o.claims),t.addResponseMode(Se.FRAGMENT),o&&o.extraQueryParameters&&t.addExtraQueryParameters(o&&o.extraQueryParameters),[2,t.createQueryString()]})})},Lr.prototype.acquireToken=function(a,c,s){return l(this,void 0,void 0,function(){var t,r,n,o,i;return y(this,function(e){switch(e.label){case 0:if(!a||W.isEmpty(a.code))throw F.createTokenRequestCannotBeMadeError();if((t=a&&a.authority?yr.createInstance(a.authority,this.networkClient):this.defaultAuthority).discoveryComplete())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw r=e.sent(),F.createEndpointDiscoveryIncompleteError(r);case 4:return(n=new wr).addClientId(this.config.authOptions.clientId),n.addRedirectUri(a.redirectUri||this.getRedirectUri()),o=new It(a.scopes||[]),n.addScopes(o),n.addAuthorizationCode(a.code),n.addCodeVerifier(a.codeVerifier),n.addGrantType(Re.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),i=t.tokenEndpoint,[4,this.getTokenResponse(i,n,t,s,c)];case 5:return[2,e.sent()]}})})},Lr.prototype.getValidToken=function(f){return l(this,void 0,void 0,function(){var t,r,n,o,i,a,c,s,u,d,h,p,l;return y(this,function(e){switch(e.label){case 0:if(!f)throw dt.createEmptyTokenRequestError();if(!f.account)throw F.createNoAccountInSilentRequestError();if(t=new It(f.scopes||[]),r=this.unifiedCacheManager.getAccount(At.generateAccountCacheKey(f.account)),n=r.homeAccountId,o=r.environment,i=this.fetchAccessToken(n,o,t,r.realm),a=this.fetchRefreshToken(n,o),!i)throw F.createNoTokensFoundError();if(!f.forceRefresh&&!this.isTokenExpired(i.expiresOn))return[3,5];if(!a)throw F.createNoTokensFoundError();if((c=f.authority?yr.createInstance(f.authority,this.networkClient):this.defaultAuthority).authorityType===ft.Adfs)throw F.createInvalidAuthorityTypeError(c.canonicalAuthority);if(c.discoveryComplete())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw s=e.sent(),F.createEndpointDiscoveryIncompleteError(s);case 4:return u=c.tokenEndpoint,d={refreshToken:a.secret,scopes:f.scopes,authority:c.canonicalAuthority},[2,this.renewToken(d,c,u)];case 5:return h=this.fetchIdToken(n,o,r.realm),p=new gr(h.secret,this.cryptoUtils),l=It.fromString(i.target),[2,{uniqueId:p.claims.oid||p.claims.sub,tenantId:p.claims.tid,scopes:l.asArray(),idToken:p.rawIdToken,idTokenClaims:p.claims,accessToken:i.secret,fromCache:!0,account:At.toIAccount(r),expiresOn:new Date(i.expiresOn),extExpiresOn:new Date(i.extendedExpiresOn),familyId:null,state:""}]}})})},Lr.prototype.logout=function(n,o){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){switch(e.label){case 0:this.unifiedCacheManager.removeAccount(At.generateAccountCacheKey(n)),t="";try{t="?"+ye.POST_LOGOUT_URI+"="+encodeURIComponent(this.getPostLogoutRedirectUri())}catch(e){}if((o=o||this.defaultAuthority).authorityType===ft.Adfs)throw F.createInvalidAuthorityTypeError(o.canonicalAuthority);if(o.discoveryComplete())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,o.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw r=e.sent(),F.createEndpointDiscoveryIncompleteError(r);case 4:return[2,""+o.endSessionEndpoint+t]}})})},Lr.prototype.handleFragmentResponse=function(e,t){var r=new Pr(this.config.authOptions.clientId,this.unifiedCacheManager,this.cryptoUtils,this.logger),n=new pt(e).getDeserializedHash();return r.validateServerAuthorizationCodeResponse(n,t,this.cryptoUtils),n.code},Lr.prototype.fetchIdToken=function(e,t,r){var n=At.generateCredentialCacheKey(e,t,Ue.ID_TOKEN,this.config.authOptions.clientId,r);return this.unifiedCacheManager.getCredential(n)},Lr.prototype.fetchAccessToken=function(e,t,r,n){var o={homeAccountId:e,environment:t,credentialType:Ue.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:n,target:r.printScopes()},i=this.unifiedCacheManager.getCredentialsFilteredBy(o),a=Object.values(i.accessTokens);return!(1<a.length)&&a.length<1?null:a[0]},Lr.prototype.fetchRefreshToken=function(e,t){var r=At.generateCredentialCacheKey(e,t,Ue.REFRESH_TOKEN,this.config.authOptions.clientId);return this.unifiedCacheManager.getCredential(r)},Lr.prototype.isTokenExpired=function(e){return(Number(e)||0)<Ut.nowSeconds()+this.config.systemOptions.tokenRenewalOffsetSeconds},Lr.prototype.getTokenResponse=function(o,i,a,c,s){return l(this,void 0,void 0,function(){var t,r,n;return y(this,function(e){switch(e.label){case 0:return[4,this.networkClient.sendPostRequestAsync(o,{body:i.createQueryString(),headers:this.createDefaultTokenRequestHeaders()})];case 1:return t=e.sent(),(r=new Pr(this.config.authOptions.clientId,this.unifiedCacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),(n=r.generateAuthenticationResult(t.body,a,c)).state=s,[2,n]}})})},Lr.prototype.renewToken=function(n,o,i){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){switch(e.label){case 0:return(t=new wr).addClientId(this.config.authOptions.clientId),t.addRedirectUri(this.getRedirectUri()),r=new It(n.scopes||[]),t.addScopes(r),t.addRefreshToken(n.refreshToken),t.addGrantType(Re.REFRESH_TOKEN_GRANT),t.addClientInfo(),[4,this.getTokenResponse(i,t,o)];case 1:return[2,e.sent()]}})})},Lr.prototype.getRedirectUri=function(){if(this.config.authOptions.redirectUri){if("function"==typeof this.config.authOptions.redirectUri)return this.config.authOptions.redirectUri();if(!W.isEmpty(this.config.authOptions.redirectUri))return this.config.authOptions.redirectUri}throw dt.createRedirectUriEmptyError()},Lr.prototype.getPostLogoutRedirectUri=function(){if(this.config.authOptions.postLogoutRedirectUri){if("function"==typeof this.config.authOptions.postLogoutRedirectUri)return this.config.authOptions.postLogoutRedirectUri();if(!W.isEmpty(this.config.authOptions.postLogoutRedirectUri))return this.config.authOptions.postLogoutRedirectUri}throw dt.createPostLogoutRedirectUriEmptyError()},Lr.prototype.getAccount=function(e,t,r){var n=this.unifiedCacheManager.getAccountsFilteredBy({homeAccountId:e,environment:t,realm:r}),o=Object.keys(n).length;if(o<1)return null;if(1<o)throw F.createMultipleMatchingAccountsInCacheError();return n[0]},Lr);function Lr(e){var t=Mr.call(this,e)||this;return vt.setKnownAuthorities(t.config.authOptions.knownAuthorities),t}var Dr;t(Hr,Dr=cr),Hr.prototype.getAuthCodeUrl=function(r){return l(this,void 0,void 0,function(){var t;return y(this,function(e){return t=this.createAuthCodeUrlQueryString(r),[2,this.defaultAuthority.authorizationEndpoint+"?"+t]})})},Hr.prototype.acquireToken=function(n){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){switch(e.label){case 0:return this.logger.info("in acquireToken call"),[4,this.executeTokenRequest(this.defaultAuthority,n)];case 1:return t=e.sent(),(r=new Pr(this.config.authOptions.clientId,this.unifiedCacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[2,r.generateAuthenticationResult(t.body,this.defaultAuthority)]}})})},Hr.prototype.executeTokenRequest=function(n,o){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){return t=this.createTokenRequestBody(o),r=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(n.tokenEndpoint,t,r)]})})},Hr.prototype.createTokenRequestBody=function(e){var t=new wr;t.addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri);var r=new It(e.scopes||[]);return t.addScopes(r),t.addAuthorizationCode(e.code),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),t.addGrantType(Re.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),t.createQueryString()},Hr.prototype.createAuthCodeUrlQueryString=function(e){var t=new wr;t.addClientId(this.config.authOptions.clientId);var r=new It(e.scopes||[]);e.extraScopesToConsent&&r.appendScopes(e.extraScopesToConsent),t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),e.codeChallenge&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.state&&t.addState(e.state),e.prompt&&t.addPrompt(e.prompt),e.loginHint&&t.addLoginHint(e.loginHint),e.domainHint&&t.addDomainHint(e.domainHint),e.nonce&&t.addNonce(e.nonce),e.claims&&t.addClaims(e.claims),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()};function Hr(e){return Dr.call(this,e)||this}var Kr;t(qr,Kr=cr),qr.prototype.acquireToken=function(n){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){switch(e.label){case 0:return[4,this.getDeviceCode(n)];case 1:return t=e.sent(),n.deviceCodeCallback(t),[4,this.acquireTokenWithDeviceCode(n,t)];case 2:return r=e.sent(),[2,JSON.stringify(r)]}})})},qr.prototype.getDeviceCode=function(n){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){return t=this.createQueryString(n),r=this.createDefaultLibraryHeaders(),[2,this.executePostRequestToDeviceCodeEndpoint(this.defaultAuthority.deviceCodeEndpoint,t,r)]})})},qr.prototype.executePostRequestToDeviceCodeEndpoint=function(s,u,d){return l(this,void 0,void 0,function(){var t,r,n,o,i,a,c;return y(this,function(e){switch(e.label){case 0:return[4,this.networkClient.sendPostRequestAsync(s,{body:u,headers:d})];case 1:return t=e.sent().body,r=t.user_code,n=t.device_code,o=t.verification_uri,i=t.expires_in,a=t.interval,c=t.message,[2,{userCode:r,deviceCode:n,verificationUri:o,expiresIn:i,interval:a,message:c}]}})})},qr.prototype.createQueryString=function(e){var t=new wr,r=new It(e.scopes||[]);return t.addScopes(r),t.addClientId(this.config.authOptions.clientId),t.createQueryString()},qr.prototype.acquireTokenWithDeviceCode=function(u,n){return l(this,void 0,void 0,function(){var a,c,s,t,r=this;return y(this,function(e){return a=this.createTokenRequestBody(u,n),c=this.createDefaultTokenRequestHeaders(),s=Ut.nowSeconds()+n.expiresIn,t=1e3*n.interval,[2,new Promise(function(n,o){var i=setInterval(function(){return l(r,void 0,void 0,function(){var t,r;return y(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),u.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(i),o(F.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return Ut.nowSeconds()>s?(this.logger.error("Device code expired. Expiration time of device code was "+s),clearInterval(i),o(F.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return[4,this.executePostToTokenEndpoint(this.defaultAuthority.tokenEndpoint,a,c)];case 3:(t=e.sent()).body&&t.body.error==he?this.logger.info(t.body.error_description):(clearInterval(i),n(t.body)),e.label=4;case 4:return[3,6];case 5:return r=e.sent(),clearInterval(i),o(r),[3,6];case 6:return[2]}})})},t)})]})})},qr.prototype.createTokenRequestBody=function(e,t){var r=new wr,n=new It(e.scopes||[]);return r.addScopes(n),r.addClientId(this.config.authOptions.clientId),r.addGrantType(Re.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode),r.createQueryString()};function qr(e){return Kr.call(this,e)||this}var jr,Gr=(t(Fr,jr=cr),Fr.prototype.acquireToken=function(n){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){switch(e.label){case 0:return[4,this.executeTokenRequest(n,this.defaultAuthority)];case 1:return t=e.sent(),(r=new Pr(this.config.authOptions.clientId,this.unifiedCacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[2,r.generateAuthenticationResult(t.body,this.defaultAuthority)]}})})},Fr.prototype.executeTokenRequest=function(n,o){return l(this,void 0,void 0,function(){var t,r;return y(this,function(e){return t=this.createTokenRequestBody(n),r=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(o.tokenEndpoint,t,r)]})})},Fr.prototype.createTokenRequestBody=function(e){var t=new wr,r=new It(e.scopes||[]);return t.addScopes(r),t.addClientId(this.config.authOptions.clientId),t.addGrantType(Re.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addRefreshToken(e.refreshToken),t.createQueryString()},Fr);function Fr(e){return jr.call(this,e)||this}var zr;t(Br,zr=cr),Br.prototype.acquireToken=function(p){return l(this,void 0,void 0,function(){var t,r,n,o,i,a,c,s,u,d,h;return y(this,function(e){if(!p.account)throw F.createNoAccountInSilentRequestError();if(t=new It(p.scopes||[]),r=At.generateAccountCacheKey(p.account),n=this.unifiedCacheManager.getAccount(r),o=n.homeAccountId,i=n.environment,a=this.readIdTokenFromCache(o,i,n.realm),c=new gr(a.secret,this.config.cryptoInterface),s=this.readAccessTokenFromCache(o,i,t,n.realm),u=this.readRefreshTokenFromCache(o,i),p.forceRefresh||!s||this.isTokenExpired(s.expiresOn)){if(!u)throw F.createNoTokensFoundError();return d=new Gr(this.config),h={scopes:p.scopes,refreshToken:u.secret,authority:p.authority},[2,d.acquireToken(h)]}return[2,{uniqueId:c.claims.oid||c.claims.sub,tenantId:c.claims.tid,scopes:t.asArray(),account:At.toIAccount(n),idToken:a.secret,idTokenClaims:c.claims,accessToken:s.secret,fromCache:!0,expiresOn:new Date(s.expiresOn),extExpiresOn:new Date(s.extendedExpiresOn),familyId:null}]})})},Br.prototype.readIdTokenFromCache=function(e,t,r){var n=At.generateCredentialCacheKey(e,t,Ue.ID_TOKEN,this.config.authOptions.clientId,r);return this.unifiedCacheManager.getCredential(n)},Br.prototype.readAccessTokenFromCache=function(e,t,r,n){var o={homeAccountId:e,environment:t,credentialType:Ue.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:n,target:r.printScopes()},i=this.unifiedCacheManager.getCredentialsFilteredBy(o),a=Object.values(i.accessTokens);return!(1<a.length)&&a.length<1?null:a[0]},Br.prototype.readRefreshTokenFromCache=function(e,t){var r=At.generateCredentialCacheKey(e,t,Ue.REFRESH_TOKEN,this.config.authOptions.clientId);return this.unifiedCacheManager.getCredential(r)},Br.prototype.isTokenExpired=function(e){return(Number(e)||0)<Ut.nowSeconds()+this.config.systemOptions.tokenRenewalOffsetSeconds};function Br(e){return zr.call(this,e)||this}function Wr(){}var Yr=(Vr.setRequestState=function(e,t){return W.isEmpty(e)?t:""+t+ie+e},Vr.getUserRequestState=function(e){if(!W.isEmpty(e)){var t=e.indexOf(ie);if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},Vr);function Vr(){}var Qr,Jr,Xr,Zr,$r="localStorage",en="sessionStorage",tn="interaction.status",rn="interaction_in_progress",nn="invalid_grant",on=483,an=600,cn=50,sn="msal.js.browser";(Jr=Qr=Qr||{}).GET="GET",Jr.POST="POST",(Zr=Xr=Xr||{}).AUTHORITY="authority",Zr.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",Zr.SESSION_STATE="session.state",Zr.REQUEST_STATE="request.state",Zr.NONCE_IDTOKEN="nonce.id_token",Zr.ORIGIN_URI="request.origin",Zr.RENEW_STATUS="token.renew.status",Zr.URL_HASH="urlHash",Zr.REQUEST_PARAMS="request.params",Zr.SCOPES="scopes";var un=(dn.prototype.sendGetRequestAsync=function(n,o){return h(this,void 0,void 0,function(){var t,r;return p(this,function(e){switch(e.label){case 0:return[4,fetch(n,{method:Qr.GET,headers:this.getFetchHeaders(o)})];case 1:return t=e.sent(),r={headers:this.getHeaderMap(t.headers)},[4,t.json()];case 2:return[2,(r.body=e.sent(),r.status=t.status,r)]}})})},dn.prototype.sendPostRequestAsync=function(o,i){return h(this,void 0,void 0,function(){var t,r,n;return p(this,function(e){switch(e.label){case 0:return t=i&&i.body||"",[4,fetch(o,{method:Qr.POST,headers:this.getFetchHeaders(i),body:t})];case 1:return r=e.sent(),n={headers:this.getHeaderMap(r.headers)},[4,r.json()];case 2:return[2,(n.body=e.sent(),n.status=r.status,n)]}})})},dn.prototype.getFetchHeaders=function(e){var r=new Headers;return e&&e.headers&&e.headers.forEach(function(e,t){r.append(t,e)}),r},dn.prototype.getHeaderMap=function(e){var r=new Map;return e.forEach(function(e,t){r.set(t,e)}),r},dn);function dn(){}var hn,pn={noWindowObjectError:{code:"no_window_object",desc:"No window object detected."},pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorWindowTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a login_hint, sid or account object."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},tokenRequestCacheError:{code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."}},ln=(e(fn,hn=u),fn.createNoWindowObjectError=function(){return new fn(pn.noWindowObjectError.code,pn.noWindowObjectError.desc)},fn.createPkceNotGeneratedError=function(e){return new fn(pn.pkceNotGenerated.code,pn.pkceNotGenerated.desc+" Detail:"+e)},fn.createCryptoNotAvailableError=function(e){return new fn(pn.cryptoDoesNotExist.code,pn.cryptoDoesNotExist.desc+" Detail:"+e)},fn.createHttpMethodNotImplementedError=function(e){return new fn(pn.httpMethodNotImplementedError.code,pn.httpMethodNotImplementedError.desc+" Given Method: "+e)},fn.createEmptyNavigationUriError=function(){return new fn(pn.emptyNavigateUriError.code,pn.emptyNavigateUriError.desc)},fn.createEmptyHashError=function(e){return new fn(pn.hashEmptyError.code,pn.hashEmptyError.desc+" Given Url: "+e)},fn.createInteractionInProgressError=function(){return new fn(pn.interactionInProgress.code,pn.interactionInProgress.desc)},fn.createPopupWindowError=function(e){var t=pn.popUpWindowError.desc;return t=W.isEmpty(e)?t:t+" Details: "+e,new fn(pn.popUpWindowError.code,t)},fn.createEmptyWindowCreatedError=function(){return new fn(pn.emptyWindowError.code,pn.emptyWindowError.desc)},fn.createUserCancelledError=function(){return new fn(pn.userCancelledError.code,pn.userCancelledError.desc)},fn.createMonitorWindowTimeoutError=function(e){var t="URL navigated to is "+e+", "+pn.monitorWindowTimeoutError.desc;return new fn(pn.monitorWindowTimeoutError.code,t)},fn.createRedirectInIframeError=function(e){return new fn(pn.redirectInIframeError.code,pn.redirectInIframeError.desc+" (window.parent !== window) => "+e)},fn.createBlockReloadInHiddenIframeError=function(){return new fn(pn.blockTokenRequestsInHiddenIframeError.code,pn.blockTokenRequestsInHiddenIframeError.desc)},fn.createIframeClosedPrematurelyError=function(){return new fn(pn.iframeClosedPrematurelyError.code,pn.iframeClosedPrematurelyError.desc)},fn.createSilentSSOInsufficientInfoError=function(){return new fn(pn.silentSSOInsufficientInfoError.code,pn.silentSSOInsufficientInfoError.desc)},fn.createSilentPromptValueError=function(e){return new fn(pn.silentPromptValueError.code,pn.silentPromptValueError.desc+" Given value: "+e)},fn.createTokenRequestCacheError=function(e){return new fn(pn.tokenRequestCacheError.code,pn.tokenRequestCacheError.desc+" Error Detail: "+e)},fn);function fn(e,t){var r=hn.call(this,e,t)||this;return Object.setPrototypeOf(r,fn.prototype),r.name="BrowserAuthError",r}var yn=(mn.prototype.sendGetRequestAsync=function(t,r){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,this.sendRequestAsync(t,Qr.GET,r)]})})},mn.prototype.sendPostRequestAsync=function(t,r){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,this.sendRequestAsync(t,Qr.POST,r)]})})},mn.prototype.sendRequestAsync=function(e,t,i){var a=this;return new Promise(function(r,n){var o=new XMLHttpRequest;if(o.open(t,e,!0),a.setXhrHeaders(o,i),o.onload=function(){(o.status<200||300<=o.status)&&n(o.responseText);try{var e=JSON.parse(o.responseText),t={headers:a.getHeaderMap(o),body:e,status:o.status};r(t)}catch(e){n(o.responseText)}},o.onerror=function(){n(o.status)},"POST"===t&&i.body)o.send(i.body);else{if("GET"!==t)throw ln.createHttpMethodNotImplementedError(t);o.send()}})},mn.prototype.setXhrHeaders=function(r,e){e&&e.headers&&e.headers.forEach(function(e,t){r.setRequestHeader(t,e)})},mn.prototype.getHeaderMap=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),o=new Map;return t.forEach(function(e){var t=e.split(": "),r=t.shift(),n=t.join(": ");o.set(r,n)}),o},mn);function mn(){}var gn=(En.navigateWindow=function(e,t){t?window.location.replace(e):window.location.assign(e)},En.clearHash=function(){window.location.hash=""},En.isInIframe=function(){return window.parent!==window},En.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},En.getBrowserNetworkClient=function(){return window.fetch?new un:new yn},En.blockReloadInHiddenIframes=function(){if(pt.hashContainsKnownProperties(window.location.hash)&&En.isInIframe())throw ln.createBlockReloadInHiddenIframeError()},En.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return 0<t||0<r||0<n},En);function En(){}var vn={clientId:"",authority:re+"/",knownAuthorities:[],redirectUri:function(){return gn.getCurrentUri()},postLogoutRedirectUri:function(){return gn.getCurrentUri()},navigateToLoginRequestUrl:!0},Cn={cacheLocation:en,storeAuthStateInCookie:!1},wn={loggerCallback:function(e,t,r){if(!r)switch(e){case o.LogLevel.Error:return void console.error(t);case o.LogLevel.Info:return void console.info(t);case o.LogLevel.Verbose:return void console.debug(t);case o.LogLevel.Warning:return void console.warn(t)}},piiLoggingEnabled:!1},In=d(d({},Ge),{loggerOptions:wn,networkClient:gn.getBrowserNetworkClient(),windowHashTimeout:6e4,iframeHashTimeout:6e3,loadFrameTimeout:gn.detectIEOrEdge()?500:0});var Tn,An={storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."}},Sn=(e(_n,Tn=u),_n.createStorageNotSupportedError=function(e){return new _n(An.storageNotSupportedError.code,An.storageNotSupportedError.desc+" Given Location: "+e)},_n.createInvalidCallbackObjectError=function(e){return new _n(An.invalidCallbackObject.code,An.invalidCallbackObject.desc+" Given value for callback function: "+e)},_n.createRedirectCallbacksNotSetError=function(){return new _n(An.noRedirectCallbacksSet.code,An.noRedirectCallbacksSet.desc)},_n);function _n(e,t){var r=Tn.call(this,e,t)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,_n.prototype),r}var Rn=(bn.prototype.validateWindowStorage=function(e){if("undefined"==typeof window||!window)throw ln.createNoWindowObjectError();if(e!==$r&&e!==en)throw Sn.createStorageNotSupportedError(e);if(!window[e])throw Sn.createStorageNotSupportedError(e)},bn.prototype.migrateCacheEntries=function(){var r=this,e=te+"."+X.ID_TOKEN,t=te+"."+X.CLIENT_INFO,n=te+"."+X.ERROR,o=te+"."+X.ERROR_DESC,i=[this.windowStorage.getItem(e),this.windowStorage.getItem(t),this.windowStorage.getItem(n),this.windowStorage.getItem(o)];[X.ID_TOKEN,X.CLIENT_INFO,X.ERROR,X.ERROR_DESC].forEach(function(e,t){return r.migrateCacheEntry(e,i[t])})},bn.prototype.migrateCacheEntry=function(e,t){t&&this.setItem(this.generateCacheKey(e),t,xe.TEMPORARY)},bn.prototype.validateObjectKey=function(e){JSON.parse(e)},bn.prototype.setItem=function(e,t,r){switch(r){case xe.ACCOUNT:case xe.CREDENTIAL:case xe.APP_META_DATA:this.windowStorage.setItem(e,JSON.stringify(t));break;case xe.TEMPORARY:var n=t;this.windowStorage.setItem(e,n),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(e,n);break;default:return void console.log("Invalid Cache Type")}},bn.prototype.getItem=function(e,t){var r=this.windowStorage.getItem(e);if(W.isEmpty(r))return null;switch(t){case xe.ACCOUNT:var n=new _t;return At.toObject(n,JSON.parse(r));case xe.CREDENTIAL:switch(At.getCredentialType(e)){case Ue.ID_TOKEN:var o=new Nt;return At.toObject(o,JSON.parse(r));case Ue.ACCESS_TOKEN:var i=new Lt;return At.toObject(i,JSON.parse(r));case Ue.REFRESH_TOKEN:var a=new Kt;return At.toObject(a,JSON.parse(r))}case xe.APP_META_DATA:return JSON.parse(r);case xe.TEMPORARY:var c=this.getItemCookie(e);return this.cacheConfig.storeAuthStateInCookie?c:r;default:return console.log("Invalid Cache Type"),{}}},bn.prototype.removeItem=function(e){return this.windowStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},bn.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},bn.prototype.getKeys=function(){return Object.keys(this.windowStorage)},bn.prototype.clear=function(){var e;for(e in this.windowStorage)this.windowStorage.hasOwnProperty(e)&&-1!==e.indexOf(te)&&-1!==e.indexOf(this.clientId)&&this.removeItem(e)},bn.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},bn.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},bn.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},bn.prototype.clearMsalCookie=function(e){var t=e?Xr.NONCE_IDTOKEN+"|"+e:Xr.NONCE_IDTOKEN;this.clearItemCookie(this.generateCacheKey(t)),this.clearItemCookie(this.generateCacheKey(Xr.REQUEST_STATE)),this.clearItemCookie(this.generateCacheKey(Xr.ORIGIN_URI))},bn.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()},bn.prototype.getCache=function(){return this.windowStorage},bn.prototype.setCache=function(){},bn.prototype.generateCacheKey=function(t){try{return this.validateObjectKey(t),t}catch(e){return t.startsWith(""+te)||t.startsWith(X.ADAL_ID_TOKEN)?t:te+"."+this.clientId+"."+t}},bn.prototype.generateAuthorityKey=function(e){return""+Xr.AUTHORITY+ie+e},bn.prototype.generateNonceKey=function(e){return""+Xr.NONCE_IDTOKEN+ie+e},bn.prototype.setAuthorityCache=function(e,t){var r=this.generateAuthorityKey(t);this.setItem(this.generateCacheKey(r),e,xe.TEMPORARY)},bn.prototype.updateCacheEntries=function(e,t,r){this.setItem(this.generateCacheKey(Xr.REQUEST_STATE),e,xe.TEMPORARY),this.setItem(this.generateCacheKey(this.generateNonceKey(e)),t,xe.TEMPORARY),this.setAuthorityCache(r,e)},bn.prototype.resetRequestCache=function(r){var n=this;this.getKeys().forEach(function(e){if(!W.isEmpty(r)&&-1!==e.indexOf(r)){var t=e.split(ie);(1<t.length?t[t.length-1]:null)===r&&n.removeItem(e)}}),this.removeItem(this.generateCacheKey(Xr.REQUEST_STATE)),this.removeItem(this.generateCacheKey(Xr.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Xr.ORIGIN_URI))},bn.prototype.cleanRequest=function(){this.removeItem(this.generateCacheKey(tn));var e=this.getItem(this.generateCacheKey(Xr.REQUEST_STATE),xe.TEMPORARY);this.resetRequestCache(e||"")},bn.prototype.cacheCodeRequest=function(e,t){this.setItem(this.generateCacheKey(Xr.REQUEST_PARAMS),t.base64Encode(JSON.stringify(e)),xe.TEMPORARY)},bn.prototype.getCachedRequest=function(e,t){try{var r=this.getItem(this.generateCacheKey(Xr.REQUEST_PARAMS),xe.TEMPORARY),n=JSON.parse(t.base64Decode(r));if(this.removeItem(this.generateCacheKey(Xr.REQUEST_PARAMS)),W.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getItem(this.generateCacheKey(o),xe.TEMPORARY);n.authority=i}return n}catch(e){throw ln.createTokenRequestCacheError(e)}},bn);function bn(e,t){this.validateWindowStorage(t.cacheLocation),this.cacheConfig=t,this.windowStorage=window[this.cacheConfig.cacheLocation],this.clientId=e,this.migrateCacheEntries()}var On=(kn.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},kn);function kn(){}var Nn=(Pn.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,On.decimalToHex(e[0])+On.decimalToHex(e[1])+On.decimalToHex(e[2])+On.decimalToHex(e[3])+"-"+On.decimalToHex(e[4])+On.decimalToHex(e[5])+"-"+On.decimalToHex(e[6])+On.decimalToHex(e[7])+"-"+On.decimalToHex(e[8])+On.decimalToHex(e[9])+"-"+On.decimalToHex(e[10])+On.decimalToHex(e[11])+On.decimalToHex(e[12])+On.decimalToHex(e[13])+On.decimalToHex(e[14])+On.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},Pn.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},Pn);function Pn(e){this.cryptoObj=e}var Un=(Mn.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,c=0;a<r;c++)(t=e.charCodeAt(c))<128?i[a++]=t:(t<2048?i[a++]=192+(t>>>6):(t<65536?i[a++]=224+(t>>>12):(t<2097152?i[a++]=240+(t>>>18):(t<67108864?i[a++]=248+(t>>>24):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63)),i[a++]=128+(t>>>18&63)),i[a++]=128+(t>>>12&63)),i[a++]=128+(t>>>6&63)),i[a++]=128+(63&t));return i},Mn.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(251<r&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:247<r&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:239<r&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:223<r&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:191<r&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},Mn);function Mn(){}var xn=(Ln.prototype.urlEncode=function(e){return this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},Ln.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},Ln.prototype.encode=function(e){var t=Un.stringToUtf8Arr(encodeURIComponent(e));return this.base64EncArr(t)},Ln.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0==t?r:r.substring(0,r.length-t)+(1==t?"=":"==")},Ln.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},Ln);function Ln(){}var Dn=(Hn.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return decodeURIComponent(Un.utf8ArrToString(r))},Hn.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,c=void 0,s=0,u=0,d=0;d<n;d++)if(c=3&d,s|=this.b64ToUint6(r.charCodeAt(d))<<18-6*c,3===c||n-d==1){for(a=0;a<3&&u<o;a++,u++)i[u]=s>>>(16>>>a&24)&255;s=0}return i},Hn.prototype.b64ToUint6=function(e){return 64<e&&e<91?e-65:96<e&&e<123?e-71:47<e&&e<58?e+4:43===e?62:47===e?63:0},Hn);function Hn(){}var Kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",qn=(jn.prototype.generateCodes=function(){return h(this,void 0,void 0,function(){var t,r;return p(this,function(e){switch(e.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return r=e.sent(),[2,{verifier:t,challenge:r}]}})})},jn.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);this.cryptoObj.getRandomValues(e);var t=this.bufferToCVString(e);return this.base64Encode.urlEncode(t)}catch(e){throw ln.createPkceNotGeneratedError(e)}},jn.prototype.generateCodeChallengeFromVerifier=function(n){return h(this,void 0,void 0,function(){var t,r;return p(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(n)];case 1:return t=e.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=e.sent(),ln.createPkceNotGeneratedError(r);case 3:return[2]}})})},jn.prototype.bufferToCVString=function(e){for(var t=[],r=0;r<e.byteLength;r+=1){var n=e[r]%Kn.length;t.push(Kn[n])}return t.join("")},jn);function jn(e){this.base64Encode=new xn,this.cryptoObj=e}var Gn="SHA-256",Fn=(zn.prototype.sha256Digest=function(r){return h(this,void 0,void 0,function(){var t;return p(this,function(e){return t=Un.stringToUtf8Arr(r),[2,this.hasIECrypto()?this.getMSCryptoDigest(Gn,t):this.getSubtleCryptoDigest(Gn,t)]})})},zn.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw ln.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},zn.prototype.hasIECrypto=function(){return!!window.msCrypto},zn.prototype.hasBrowserCrypto=function(){return!!window.crypto},zn.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},zn.prototype.getSubtleCryptoDigest=function(t,r){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,window.crypto.subtle.digest(t,r)]})})},zn.prototype.getMSCryptoDigest=function(n,o){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.digest(n,o.buffer);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},zn);function zn(){if(!this.hasCryptoAPI())throw ln.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.")}var Bn=(Wn.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},Wn.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},Wn.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},Wn.prototype.generatePkceCodes=function(){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},Wn);function Wn(){this.browserCrypto=new Fn,this.b64Encode=new xn,this.b64Decode=new Dn,this.guidGenerator=new Nn(this.browserCrypto),this.pkceGenerator=new qn(this.browserCrypto)}var Yn=(Vn.prototype.handleCodeResponse=function(c){return h(this,void 0,void 0,function(){var t,r,n,o,i,a;return p(this,function(e){switch(e.label){case 0:if(W.isEmpty(c))throw ln.createEmptyHashError(c);return t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Xr.REQUEST_STATE),xe.TEMPORARY),r=this.browserStorage.generateNonceKey(t),n=this.browserStorage.getItem(this.browserStorage.generateCacheKey(r),xe.TEMPORARY),o=this.authModule.handleFragmentResponse(c,t),this.authCodeRequest.code=o,i=Yr.getUserRequestState(t),[4,this.authModule.acquireToken(this.authCodeRequest,i,n)];case 1:return a=e.sent(),this.browserStorage.cleanRequest(),[2,a]}})})},Vn);function Vn(e,t){this.authModule=e,this.browserStorage=t}var Qn,Jn=(e(Xn,Qn=Yn),Xn.prototype.initiateAuthRequest=function(e,t,r){if(W.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),ln.createEmptyNavigationUriError();this.browserStorage.setItem(this.browserStorage.generateCacheKey(Xr.ORIGIN_URI),gn.getCurrentUri(),xe.TEMPORARY),this.browserStorage.setItem(this.browserStorage.generateCacheKey(tn),rn,xe.TEMPORARY),this.browserStorage.cacheCodeRequest(t,r),this.authModule.logger.infoPii("Navigate to:"+e);var n=gn.isInIframe();if(n)throw ln.createRedirectInIframeError(n);return gn.navigateWindow(e),window},Xn.prototype.handleCodeResponse=function(c,s){return h(this,void 0,void 0,function(){var t,r,n,o,i,a;return p(this,function(e){switch(e.label){case 0:if(W.isEmpty(c))throw ln.createEmptyHashError(c);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(tn)),t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Xr.REQUEST_STATE),xe.TEMPORARY),r=this.browserStorage.generateNonceKey(t),n=this.browserStorage.getItem(this.browserStorage.generateCacheKey(r),xe.TEMPORARY),this.authCodeRequest=this.browserStorage.getCachedRequest(t,s),o=this.authModule.handleFragmentResponse(c,t),this.authCodeRequest.code=o,this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Xr.URL_HASH)),i=Yr.getUserRequestState(t),[4,this.authModule.acquireToken(this.authCodeRequest,i,n)];case 1:return a=e.sent(),this.browserStorage.cleanRequest(),[2,a]}})})},Xn);function Xn(){return null!==Qn&&Qn.apply(this,arguments)||this}var Zn,$n=(e(eo,Zn=Yn),eo.prototype.initiateAuthRequest=function(e,t){if(W.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),ln.createEmptyNavigationUriError();return this.authCodeRequest=t,this.browserStorage.setItem(this.browserStorage.generateCacheKey(tn),rn,xe.TEMPORARY),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,$,on,an)},eo.prototype.monitorWindowForHash=function(c,e,s){var u=this;return new Promise(function(r,n){var o=e/cn,i=0,a=setInterval(function(){if(c.closed)return u.cleanPopup(),clearInterval(a),void n(ln.createUserCancelledError());var e;try{e=c.location.href}catch(e){}if(e&&"about:blank"!==e){if(i++,pt.hashContainsKnownProperties(e)){var t=c.location.hash;return u.cleanPopup(c),clearInterval(a),void r(t)}return o<i?(u.cleanPopup(c),clearInterval(a),void n(ln.createMonitorWindowTimeoutError(s))):void 0}},cn)})},eo.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=a/2-r/2+o,u=c/2-n/2+i,d=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+s);if(!d)throw ln.createEmptyWindowCreatedError();return d.focus&&d.focus(),this.currentWindow=d,window.addEventListener("beforeunload",this.unloadWindow),d}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(tn)),ln.createPopupWindowError(e.toString())}},eo.prototype.unloadWindow=function(e){this.browserStorage.cleanRequest(),this.currentWindow.close(),delete e.returnValue},eo.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(tn))},eo);function eo(e,t){var r=Zn.call(this,e,t)||this;return r.unloadWindow=r.unloadWindow.bind(r),r}var to,ro=(e(no,to=Yn),no.prototype.initiateAuthRequest=function(n,o,i){return h(this,void 0,void 0,function(){var t,r;return p(this,function(e){switch(e.label){case 0:if(W.isEmpty(n))throw this.authModule.logger.info("Navigate url is empty"),ln.createEmptyNavigationUriError();return this.authCodeRequest=o,t=i?"msalTokenFrame"+i:"msalTokenFrame",this.loadFrameTimeout?[4,this.loadFrame(n,t)]:[3,2];case 1:return r=e.sent(),[3,3];case 2:r=this.loadFrameSync(n,t),e.label=3;case 3:return[2,r]}})})},no.prototype.monitorFrameForHash=function(c,e,s){var u=this,d=c.contentWindow;return new Promise(function(r,n){var o=e/cn,i=0,a=setInterval(function(){if(d.closed)return u.removeHiddenIframe(c),clearInterval(a),void n(ln.createIframeClosedPrematurelyError());var e;try{e=d.location.href}catch(e){}if(i++,pt.hashContainsKnownProperties(e)){var t=d.location.hash;return u.removeHiddenIframe(c),clearInterval(a),void r(t)}return o<i?(u.removeHiddenIframe(c),clearInterval(a),void n(ln.createMonitorWindowTimeoutError(s))):void 0},cn)})},no.prototype.loadFrame=function(n,o){var i=this;return new Promise(function(t,r){setTimeout(function(){var e=i.loadFrameSync(n,o);e?t(e):r("Unable to load iframe with name: "+o)},i.loadFrameTimeout)})},no.prototype.loadFrameSync=function(e,t){var r=this.getHiddenIframe(t);return r?(""!==r.src&&"about:blank"!==r.src||(r.src=e),r):null},no.prototype.getHiddenIframe=function(e){if(void 0===e)return null;var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},no.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},no);function no(e,t,r){var n=to.call(this,e,t)||this;return n.loadFrameTimeout=r,n}var oo=(io.prototype.handleRedirectCallback=function(n){return h(this,void 0,void 0,function(){var t,r;return p(this,function(e){switch(e.label){case 0:if(console.warn("handleRedirectCallback will be deprecated upon release of msal-browser@v2.0.0. Please transition to using handleRedirectPromise()."),!n)throw Sn.createInvalidCallbackObjectError(n);e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.tokenExchangePromise];case 2:return(t=e.sent())&&n(null,t),[3,4];case 3:return r=e.sent(),n(r),[3,4];case 4:return[2]}})})},io.prototype.handleRedirectPromise=function(){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,this.tokenExchangePromise]})})},io.prototype.handleRedirectResponse=function(){return h(this,void 0,void 0,function(){var t,r,n,o,i,a;return p(this,function(e){return t=window.location.hash,r=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Xr.URL_HASH),xe.TEMPORARY),n=pt.hashContainsKnownProperties(t),o=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Xr.ORIGIN_URI),xe.TEMPORARY),i=gn.getCurrentUri(),o===i?n?(gn.clearHash(),[2,this.handleHash(t)]):[2,this.handleHash(r)]:this.config.auth.navigateToLoginRequestUrl&&n&&!gn.isInIframe()?(a=this.browserStorage.generateCacheKey(Xr.URL_HASH),this.browserStorage.setItem(a,t,xe.TEMPORARY),W.isEmpty(o)||"null"===o?(this.authModule.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),gn.navigateWindow("/",!0)):gn.navigateWindow(o,!0),[2,null]):n?this.config.auth.navigateToLoginRequestUrl?[2,null]:(gn.clearHash(),[2,this.handleHash(t)]):[2,this.handleHash(r)]})})},io.prototype.handleHash=function(r){return h(this,void 0,void 0,function(){var t;return p(this,function(e){return t=new Jn(this.authModule,this.browserStorage),W.isEmpty(r)?(this.browserStorage.cleanRequest(),[2,null]):[2,t.handleCodeResponse(r,this.browserCrypto)]})})},io.prototype.loginRedirect=function(t){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,this.acquireTokenRedirect(this.generateLoginRequest(t))]})})},io.prototype.acquireTokenRedirect=function(a){return h(this,void 0,void 0,function(){var t,r,n,o,i;return p(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),t=this.preflightRequest(a),[4,this.generateAuthorizationCodeRequest(t)];case 1:return r=e.sent(),n=new Jn(this.authModule,this.browserStorage),[4,this.authModule.createUrl(t)];case 2:return o=e.sent(),n.initiateAuthRequest(o,r,this.browserCrypto),[3,4];case 3:throw i=e.sent(),this.browserStorage.cleanRequest(),i;case 4:return[2]}})})},io.prototype.loginPopup=function(t){return h(this,void 0,void 0,function(){return p(this,function(e){return[2,this.acquireTokenPopup(this.generateLoginRequest(t))]})})},io.prototype.acquireTokenPopup=function(i){return h(this,void 0,void 0,function(){var t,r,n,o;return p(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),t=this.preflightRequest(i),[4,this.generateAuthorizationCodeRequest(t)];case 1:return r=e.sent(),[4,this.authModule.createUrl(t)];case 2:return n=e.sent(),[4,this.popupTokenHelper(n,r)];case 3:return[2,e.sent()];case 4:throw o=e.sent(),this.browserStorage.cleanRequest(),o;case 5:return[2]}})})},io.prototype.popupTokenHelper=function(o,i){return h(this,void 0,void 0,function(){var t,r,n;return p(this,function(e){switch(e.label){case 0:return t=new $n(this.authModule,this.browserStorage),r=t.initiateAuthRequest(o,i),[4,t.monitorWindowForHash(r,this.config.system.windowHashTimeout,o)];case 1:return n=e.sent(),[4,t.handleCodeResponse(n)];case 2:return[2,e.sent()]}})})},io.prototype.ssoSilent=function(i){return h(this,void 0,void 0,function(){var t,r,n,o;return p(this,function(e){switch(e.label){case 0:if(gn.blockReloadInHiddenIframes(),W.isEmpty(i.loginHint))throw ln.createSilentSSOInsufficientInfoError();if(i.prompt&&i.prompt!==Ae.NONE)throw ln.createSilentPromptValueError(i.prompt);return t=this.initializeRequest(d(d({},i),{prompt:Ae.NONE})),[4,this.generateAuthorizationCodeRequest(t)];case 1:return r=e.sent(),n=t.scopes?t.scopes.join(" "):"",[4,this.authModule.createUrl(t)];case 2:return o=e.sent(),[2,this.silentTokenHelper(o,r,n)]}})})},io.prototype.acquireTokenSilent=function(u){return h(this,void 0,void 0,function(){var t,r,n,o,i,a,c,s;return p(this,function(e){switch(e.label){case 0:gn.blockReloadInHiddenIframes(),e.label=1;case 1:return e.trys.push([1,3,,7]),[4,this.authModule.getValidToken(u)];case 2:return[2,e.sent()];case 3:return t=e.sent(),r=t instanceof Ar,n=t instanceof Or,o=t.errorCode===nn,r&&o&&!n?(i=this.initializeRequest(d(d({},u),{redirectUri:"",prompt:Ae.NONE})),[4,this.generateAuthorizationCodeRequest(i)]):[3,6];case 4:return a=e.sent(),[4,this.authModule.createUrl(i)];case 5:return c=e.sent(),s=u.scopes?u.scopes.join(" "):"",[2,this.silentTokenHelper(c,a,s)];case 6:throw t;case 7:return[2]}})})},io.prototype.silentTokenHelper=function(o,i,a){return h(this,void 0,void 0,function(){var t,r,n;return p(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,(t=new ro(this.authModule,this.browserStorage,this.config.system.loadFrameTimeout)).initiateAuthRequest(o,i,a)];case 1:return r=e.sent(),[4,t.monitorFrameForHash(r,this.config.system.iframeHashTimeout,o)];case 2:return n=e.sent(),[4,t.handleCodeResponse(n)];case 3:return[2,e.sent()];case 4:throw e.sent();case 5:return[2]}})})},io.prototype.logout=function(e,t){var r=W.isEmpty(t)?this.defaultAuthorityInstance:yr.createInstance(this.config.auth.authority,this.config.system.networkClient);this.authModule.logout(e,r).then(function(e){gn.navigateWindow(e)})},io.prototype.getRedirectUri=function(){return this.authModule.getRedirectUri()},io.prototype.getPostLogoutRedirectUri=function(){return this.authModule.getPostLogoutRedirectUri()},io.prototype.getAllAccounts=function(){return this.authModule.getAllAccounts()},io.prototype.getAccountByUsername=function(t){return this.getAllAccounts().filter(function(e){return e.username===t})[0]},io.prototype.interactionInProgress=function(){return this.browserStorage.getItem(this.browserStorage.generateCacheKey(tn),xe.TEMPORARY)===rn},io.prototype.generateLoginRequest=function(e){var t=d({},e);return t.scopes?t.scopes.push(ae,ce):t.scopes=[ae,ce],t},io.prototype.preflightRequest=function(e){if(gn.blockReloadInHiddenIframes(),this.interactionInProgress())throw ln.createInteractionInProgressError();return this.initializeRequest(e)},io.prototype.initializeRequest=function(e){var t=d({},e);if(W.isEmpty(t.loginHint)){var r=this.browserStorage.getItem(X.ADAL_ID_TOKEN,xe.TEMPORARY);if(!W.isEmpty(r)){var n=new gr(r,this.browserCrypto);this.browserStorage.removeItem(X.ADAL_ID_TOKEN),n.claims&&n.claims.upn&&(t.loginHint=n.claims.upn)}}return t.state=Yr.setRequestState(e&&e.state||"",this.browserCrypto.createNewGuid()),t.correlationId=e&&e.correlationId||this.browserCrypto.createNewGuid(),t.authority=e&&e.authority||this.defaultAuthorityInstance.canonicalAuthority,W.isEmpty(t.nonce)&&(t.nonce=this.browserCrypto.createNewGuid()),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority),t},io.prototype.generateAuthorizationCodeRequest=function(n){return h(this,void 0,void 0,function(){var t,r;return p(this,function(e){switch(e.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=e.sent(),r=d(d({},n),{code:"",codeVerifier:t.verifier}),n.codeChallenge=t.challenge,n.codeChallengeMethod=ue,[2,r]}})})},io);function io(e){if(this.config=function(e){var t=e.auth,r=e.cache,n=e.system;return{auth:d(d({},vn),t),cache:d(d({},Cn),r),system:d(d({},In),n)}}(e),this.browserCrypto=new Bn,this.networkClient=this.config.system.networkClient,this.browserStorage=new Rn(this.config.auth.clientId,this.config.cache),vt.setKnownAuthorities(this.config.auth.knownAuthorities),this.defaultAuthorityInstance=yr.createInstance(this.config.auth.authority,this.config.system.networkClient),this.defaultAuthorityInstance.authorityType===ft.Adfs)throw F.createInvalidAuthorityTypeError(this.defaultAuthorityInstance.canonicalAuthority);this.authModule=new xr({authOptions:{clientId:this.config.auth.clientId,authority:this.config.auth.authority?yr.createInstance(this.config.auth.authority,this.config.system.networkClient):this.defaultAuthorityInstance,knownAuthorities:this.config.auth.knownAuthorities,redirectUri:this.config.auth.redirectUri,postLogoutRedirectUri:this.config.auth.postLogoutRedirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,telemetry:this.config.system.telemetry},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,libraryInfo:{sku:sn,version:"2.0.0-beta.2",cpu:"",os:""}}),this.tokenExchangePromise=this.handleRedirectResponse()}o.AuthError=u,o.AuthErrorMessage=r,o.AuthenticationResult=Wr,o.BrowserAuthError=ln,o.BrowserAuthErrorMessage=pn,o.BrowserConfigurationAuthError=Sn,o.BrowserConfigurationAuthErrorMessage=An,o.InteractionRequiredAuthError=Or,o.Logger=V,o.PublicClientApplication=oo,Object.defineProperty(o,"__esModule",{value:!0})});
